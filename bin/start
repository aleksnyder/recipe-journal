#!/bin/bash

set -e

export REPOSITORY_ROOT=$(realpath "$(dirname "$0")/..")

# Set environment variables
if [ -f .env ]; then
  set -o allexport
  source .env
  set +o allexport
else
  export DATABASE_URL="postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable"
  export PORT=8080
fi

./bin/check_postgres_up

# Run the application
go run ./cmd/web/main.go